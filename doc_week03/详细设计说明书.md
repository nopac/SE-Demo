
# 详细设计说明书

##### 文件状态：已发布
##### 当前版本：v4.1

##### 作者：
| 姓名 | 学号       | 团队     |
| ---- | ---------- | -------- |
| 王恬 | 2019011409 | 无言以对 |
| 王亚伟| 2019013006 | 无言以对 |
| 王飞龙| 2017010794 | 无言以对 |
| 张雨| 2019010347 | 无言以对 |

##### 完成日期：2022/10/03

##### 版本更新信息：

| 版本号 |  更新时间  |   更新信息   | 更新人员 |
| :----: | :--------: | :----------: | :------: |
| v1.0   | 2022/09/28 | 完善数据库设计部分 |   王恬   |
| v2.0   |2022/09/28  | 单元设计完善      |   王亚伟  |
| v2.1   |2022/10/02  | 单元设计完善      |   王亚伟  |
|  v3.0  |2022/10/03  | 单元设计完善      |   王飞龙  |
|  v4.0  |2022/10/03  | 单元设计完善      |   张雨  |
|  v4.1  |2022/10/04  | 完善数据库设计      |   王恬  |
|  v4.2  |2022/10/04  | 完善数据库设计      |   郎海峰  |

## 引言
本文档根据概要设计说明书，对系统功能及接口进行细化说明，作为后续开发过程中的参考。


#
## 一、程序的系统结构
### （一）单元设计说明
#### 1. 用户
##### 首页浏览搜索程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|浏览商品|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|前端网页地址|暂无|GoodsService|GoodsDao|前端存储：商品信息 后端存储：商品列表，人员列表
##### 注释设计：
 - 用户状态：未登录状态和已登录状态。

 - 首页展示：已登录状态下商品展示界面向用户展示的是基于推荐算法过滤后的商品，有利于用户的浏览体验。

 - 用户操作：未登录情况下只能浏览和查看商品属性，不能进行购买等其他操作。

 - 商品:对应属性下显示对应商品。
##### 测试条件：
 - 浏览的商城首页位置为\Home

 - 商城首页显示已有商品信息：包括商品图片和商品价格等

 - 首页上方的搜索栏目输入指定属性可以搜索到对应商品
##### 流程逻辑：
 - 例如用户进入商城首页，商城首页界面向用户展示的是数据库中已存在的商品。用户可以点击商品图片查看商品详细信息。
   
 - 未登录状态下用户不能将商品加入购物车或者进行购买。
   
 - 未登录状态下和已登录状态下都可以进行商品搜索操作。
##### 尚未解决的问题：
 - 未登录状态下向用户展示的是下单或者收藏量高的近期爆款商品
#
##### 首页浏览搜索程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|搜索商品|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|前端网页地址|暂无|GoodsService|GoodsDao|前端存储：商品信息 后端存储：商品列表，人员列表
##### 注释设计：
- 用户状态：未登录状态和已登录状态。

- 首页展示：已登录状态下商品展示界面向用户展示的是基于推荐算法过滤后的商品，有利于用户的浏览体验。

- 用户操作：未登录情况下只能浏览和查看商品属性，不能进行购买等其他操作，输入商品属性或者名称进行搜索。

- 商品:对应属性下显示对应商品。
##### 测试条件：
- 浏览的商城首页位置为\Home

- 商城首页显示已有商品信息：包括商品图片和商品价格等

- 首页上方的搜索栏目输入指定属性可以搜索到对应商品
##### 流程逻辑：
- 例如用户进入商城首页，商城首页界面向用户展示的是数据库中已存在的商品。用户可以点击商品图片查看商品详细信息。

- 未登录状态下用户不能将商品加入购物车或者进行购买。

- 未登录状态下和已登录状态下都可以进行商品搜索操作。
##### 尚未解决的问题：
- 可以在搜索功能里加入分类搜索，例如点击家电进入家电专区。



##### 用户注册程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|用户注册|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|输入指定格式的用户名,不得超过指定长度，不得使用非法字符|生成用户指定的id|UserController,UserService|UserDao|前端存储：用户注册信息，后端存储：用户表
##### 注释设计：
 - 该用户名是否已经被注册，已注册的用户名需重新选择

 - 用户名需符合指定格式，指定长度且不得使用非法字符

 - 密码需符合指定格式，指定长度且不得使用非法字符

 - 填写正确格式的验证码
##### 测试条件：
 - 注册的vue页面位置是/register

 - 用户用户名为未注册过的合法格式

 - 密码为符合格式没有非法字符的字符串

 - 验证码输入正确

  
##### 流程逻辑：
 - 用户进入商城首页，点击头像进行登录操作。然后进入登录界面点击注册进入注册页面，输入正确的用户名和密码，输入验证码进行注册
   
 - 此操作结束后会往后台数据库user表中插入一条用户信息。
   
 - 用户返回登录界面用注册的账户进行登录。
##### 尚未解决的问题：
 - 用户名可以重复，userid唯一也能注册成功

##### 用户登录程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|登录功能|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|用户名，密码|登录成功并进入商城首页|UserService|UserDao|前端：用户信息 后端：用户列表。商品列表
##### 注释设计：
 - 请输入合适的用户名
   
 - 请输入正确的密码
   
 - 请输入正确的验证码

 - 前端将信息参数传给userService处理

##### 测试条件：
 - 登录的vue页面位置为\login。

 - 用户名为注册过的用户名。

 - 密码为该用户名所对应的正确的密码格式。

##### 流程逻辑：
 - 用户进入商城首页点击头像进行登录，进入登录页面输入注册过的账号密码进行登录，此时当后台数据库有当前的user用户信息，则就可以登录成功。
##### 尚未解决的问题：
 - 暂无


##### 用户信息管理程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|用户可以查看和修改个人信息|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|输入新的用户名，密码以及头像|修改成功|UserService|UserDao|前端存储：用户信息 后端存储 ：用户信息列表
##### 注释设计：
 -  1.请输入格式正确的用户名
    
    2.请输入格式正确的密码
    
    3.请上传尺寸合适的头像

    4.前端将信息参数传给userService处理

##### 测试条件：
 -  1.用户信息显示的页面位置为\UserInfo
 
    2.修改的用户名为合法且未被注册使用
    
    3.合法且格式正确的密码
    
    4.尺寸大小适中的头像

##### 流程逻辑：
 -  用户修改个人信息时，输入新的用户名密码和上传个人信息后，后台会找到数据库中保存用户信息的user表并update进新的用户修改后的信息。
 -  用户需重新登录
##### 尚未解决的问题：
 - 不支持任意格式的图片 

##### 申请商家程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|用户申请成为平台商家|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|身份证；营业执照|审核中或者审核通过|UserService|UserDao|前端存储：用户信息 后端存贮：user表
##### 注释设计：
-  1.上传尺寸大小适中的身份证复印件
   
   2.上传尺寸大小适中的电子营业照

   3.前端将信息参数传给userService处理

##### 测试条件：
-  1.后端接受到的身份证照片是合法格式
   
   2.后端接受到的营业执照照片是合法格式
##### 流程逻辑：
 -  用户进入个人信息页面，点击申请商家，在点击后的弹窗中上传身份证信息和营业执照照片，管理员审核通过后成为商家。
##### 尚未解决的问题：
 -  暂无

##### 充值程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|用户进行账户充值|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|addAcount|暂无|userDao|充值成功|后端存储：user表
##### 注释设计：

 -  请选择充值资金（不低于最低额度，不高于最高额度）

 -  前端将参数信息传给addCountservice处理

##### 测试条件：
 -  用户信息的页面显示位置为\userinfo
   
 -  用户账号正常
##### 流程逻辑：
 -  用户进入我的账户信息进行，点击充值，在充值页面进行充值，后端数据库user信息表中account信息被更新
##### 尚未解决的问题：
 -  无法直接输入数字金额进行充值

##### 下单程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|商品下单|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|确认下单|orders表中插入一条数据|OrdersService|OrderDao|后端：orders表
##### 注释设计：
 - 请选择对应的商品属性

 - 请选择充值方式

 - 余额不足提醒用户充值

 - 前端将信息参数传给OrdersService处理

##### 测试条件：
 - 充值页面在\purchase

 - 商品价格小于等于用户账户余额

##### 流程逻辑：
 - 用户点击商品下的加入购物车，在购物车列表选择统一支付。

##### 尚未解决的问题：
 - 不支持快速下单

##### 评论程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|评论|受用户网络影响|输入评论不超过50字|评论成功 review表中加入一条新数据|reviewservice|reviewDao|后端存储：review表
##### 注释设计：
 - 评论字数不超过50字

 - 使用规范文明语言

 - 不得使用非法字符

 - 前端将信息参数传给reviewService处理

##### 测试条件：
 - 页面为\AllOrders


 -只有用户下单了的商品才能进行评价

##### 流程逻辑：

 -用户进入全部订单管理页面

 - 进入待评价页面

 - 选择商品进行评价

 - 选择星星数

##### 尚未解决的问题：

 - 不支持一键评价

##### 收货管理程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|收货管理|受用户网络影响|暂无|暂无|ordersService|OrderDao|后端存储：Orders表
##### 注释设计：
 - 分页查询

 - 前端将信息参数传给ordersService处理

##### 测试条件：

 - 后台数据库order表中有记录

##### 流程逻辑：
 - 用户点击个人全部订单管理即可
   
 - 页面为\AllOrders

##### 尚未解决的问题：

 - 可以显示收货记录

##### 退货管理程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|退货管理|受用户网络影响|暂无|暂无|ordersService|OrderDao|后端存储：Orders表
##### 注释设计：
- 分页查询

- 前端将信息参数传给ordersService处理

##### 测试条件：

- 后台数据库order表中有记录

##### 流程逻辑：
- 用户点击个人全部订单管理即可

- 页面为\AllOrders

##### 尚未解决的问题：

- 可以显示退货记录

##### 评价管理程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|评价管理|受用户网络影响|暂无|暂无|reviewService|reviewDao|后端存储：Orders表
##### 注释设计：
- 分页查询

- 前端将信息参数传给review Service处理

##### 测试条件：

- 后台数据库review表中有记录

##### 流程逻辑：
- 用户点击个人全部订单管理即可

- 点击评价管理

- 页面为\AllOrders

##### 尚未解决的问题：

- 可以显示评价记录
##


#### 2. 商家

#
##### 商品上架程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|商品上架|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|商品的图片，数量等描述信息|上传成功|暂无|/save/goods|goods表|
##### 注释设计：
- 商家上传商品
##### 测试条件：
- 商品的各个信息符合输入要求
##### 流程逻辑：
1. 商家输入商品信息点击确认
2. 经校验无误后将信息传送至后端程序
3. 写入数据库goods表
##### 尚未解决的问题：
- 商品信息得违规检测

##### 商品下架程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|商品下架|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|商品id|下架成功|暂无|/delete/goods/{id}|暂无|
##### 注释设计：
- 商家通过商品id下架商品
##### 测试条件：
- 商品id为正整数
##### 流程逻辑：
1. 商家选择商品点击下架
2. 前端通过商品id向后端发送下架请求
3. 后端检查该商品是否存在
4. 将goods表中该条记录修改为下架
##### 尚未解决的问题：
- 暂无

##### 商品发货更新程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|商品发货|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|快递单号|修改成功|暂无|/update/goods|暂无|
##### 注释设计：
- 商家输入快递单号发货
##### 测试条件：
1. 商品id存在
2. 快递单号合法
##### 流程逻辑：
1. 商家进入发货管理页面
2. 选择订单点击发货并输入快递单号
3. 后端程序将数据库中该条订单信息状态修改为已发货
##### 尚未解决的问题：
- 快递单号的校验

##### 商家同意退货程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|商家同意退货申请|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|暂无|同意退货的提示|暂无|/delete/exm0{status}|暂无|
##### 注释设计：
- 商家同意退货申请
##### 测试条件：
- 暂无
##### 流程逻辑：
1. 商家进入退货管理页面点击同意退货申请
2. 后端程序修改订单表中对应的订单记录状态
##### 尚未解决的问题：
- 暂无


#
#### 3. 管理员
##### 待上架商品审核程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|商品审核|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|待上架商品信息|通过或不通过|暂无|Asministrators|Asministrators|
##### 注释设计：
- 账号状态：已审核和未审核状态。
- 商品状态：已审核和未审核状态。
- 首页展示：显示存在的所有账号，分类为用户和商家，待审核账号，待审核商品。
- 用户操作：对未审核的账号及商品进行审核。
##### 测试条件：
-账号和密码符合注册规定
-待上架商品符合上架要求
##### 流程逻辑：
-管理员对待审核的账号进行规则审核，若符合规则就进行审核通过。若不符合则不通过。

-管理员对待上架商品进行审核，若符合规则就进行审核通过。若不符合则不通过。

##### 尚未解决的问题：
-待上架商品的审核规则制定
#
##### 账户审核程序描述：
|功能|性能|输入说明|输出说明|算法|接口|存储分配|
|:---|:---|:---|:---|:---|:---|:---|
|对账户进行审核|响应时间：系统用户的网络，一般正常网络响应时间不超过1s。更新时间：秒级|无|通过/不通过|暂无|Asministrators|Asministrators|
##### 注释设计：
-管理员对未审核的账户进行审核
##### 测试条件：
-用新用户进行了账户注册
##### 流程逻辑：
-1新用户进行账户注册。

-2账户为待注册账户。

-3管理员根据注册规则对账户进行审核。

-4若符合规则将进行账户注册通过，若不符合规则将申请拒绝。

##### 尚未解决的问题：
暂无
#
### （二）数据库设计

#### 1. 外部设计
##### 1). 标准描述方式
###### (1) 标志符和状态

|  表名   | 名称  |  描述信息   | 状态  |
|  ----  | ----  |  ----  | ----  |
| 用户表  | User | 用户(普通用户和商户)信息  | 使用状态 |
| 商品表  | Goods | 商品信息  | 使用状态 | 
| 订单表  | Orders | 订单信息  | 使用状态 |
| 购物车表  | cart | 用户购物车信息  | 使用状态 |
| 评论表  | review | 用户商户双向评价打分  | 使用状态 |
| 金额记录表  | AmountRecord | 用户充值支出记录  | 使用状态 |       
| 管理员表  | Asministrators | 管理员账户信息  | 使用状态 |  
| 浏览记录表  | BrowseRecord | 用户浏览商品信息  | 未使用状态 |  

###### (2) 使用它的程序

|  应用程序   | 名称  |  版本号   |
|  ----  | ----  |  ----  |
| 注册登录与信息管理  | 一般用户模块 | 1.0  |
|  订单管理 | 一般用户模块 | 1.0  |
| 商品管理  | 商户模块 | 1.0  |
| 商家订单管理  | 商户模块 | 1.0  |
| 用户管理后台系统  | 管理员模块 | 1.0  |
| 商品和商家管理后台系统  | 管理员模块 | 1.0  |
| 审查后台系统  | 管理员模块 | 1.0  |

###### (3) 约定

* 1 用户表  (User) 

|  前缀   | 说明  |
|  ----  | ----  |
|Uid  | 商户id | 
|Uname  | 姓名 | 
|Upsw  | 密码 | 
|Phone  | 手机号 | 
|Email  | 邮箱 | 
|City  | 城市 | 
|Sex  | 性别 | 
|Bank  | 银行账号 | 
|Account  | 余额 | 
|Point  | 积分 | 
|Status  | 状态 | 
|License  | 营业执照 | 
|Identity  | 身份证 | 
|Grade  | 商家等级 | 
|Turnover  | 总交易额 | 
|LikeRate  | 满意度 | 
|MLikeRate  | 商家好评率 | 
|isMerchant  | 是否为商家 | 
|IdentityNumber  | 身份证号 | 
|Address  | 地址 | 

* 2 商品表 (Goods) 

|  前缀   | 说明  |
|  ----  | ----  |
|Gid  | 商品id | 
|Gname  | 商品名称 | 
|type  | 类别 | 
|Price  | 价格 | 
|Size  | 尺寸大小 | 
|Picture  | 照片 | 
|Introduction  | 使用说明 | 
|Bargain  | 是否允许议价 | 
|Storage  | 商品数量 | 
|GCondition  | 新旧程度 | 
|Mid  | 发布人 | 
|RNumber  | 评价数 | 
|Sale  | 销售量 | 
|likeRate  | 好评率 | 
|Status  | 状态 | 

* 3 订单表 (Orders)  

|  前缀   | 说明  |
|  ----  | ----  |
|Oid  | 订单id | 
|Uid  | 用户 | 
|Gid  | 商品 | 
|Mid  | 商家 | 
|Rid  | 评价 | 
|Subtime  |    提交时间  | 
|SubSucTime  | 成交时间 | 
|SentTime  |   发货时间  | 
|Price  | 单价 | 
|RetTime  | 退货时间 | 
|RetSecTime  | 退货成功时间 | 
|status  | 状态 | 
|Commission  | 手续费 | 
|Address  | 地址 | 
|Number  |  数量| 
|DeliverID  | 快递单号 | 
|sum  |   总金额| 
|Gname  | 商品名 | 
|MNote  | 商家备注 | 

* 4 购物车表 (cart) 

|  前缀   | 说明  |
|  ----  | ----  |
| Cid| 购物车id | 
| Uid| 用户 | 
| Gid| 商品 | 
| Number|个数 | 
| Price| 单价| 
| Gname| 名称| 

* 5 评论表 (review)

|  前缀   | 说明  |
|  ----  | ----  |
| Rid | 评价id | 
| star | 星级  | 
| Remark | 文字 | 
| Time | 评价时间 | 
| Fromid | 评价者 | 
| Toid | 被评价者 | 
| Rate | 被评价者满意度 | 
| type | 类型 | 
| oid | 订单 | 

* 6 金额记录表 (AmountRecord)

|  前缀   | 说明  |
|  ----  | ----  |
| Aid | 金额记录id | 
| Type |   类型 | 
| Amount | 金额 | 
| Atime |  时间 | 
| Oid |    订单 | 
| Uid |    用户  | 
| Account |余额   | 

* 7 管理员表 (Asministrators)

|  前缀   | 说明  |
|  ----  | ----  |
| AdmID | 管理员id | 
| password | 管理员密码 | 

* 8 浏览信息表 (BrowseRecord)

|  前缀   | 说明  |
|  ----  | ----  |
| Bid | 浏览信息表的id | 
| Uid | 用户id | 
| GoodsType | 商品类型 | 
| BrowseCount | 浏览次数 | 

###### (4) 专门指导
可参考的资料：
* 软件工程哈工大耿建玲视频
* 数据库设计规范

###### (5) 支持软件

1. 数据库设计编辑工具“navicat for mysql”
2. 数据库自带工具“mysql command line client”
3. 管理员工具：navicat for mysql

##### 2). 自由表述
暂无

#### 2.结构设计

##### 1) 概念设计

###### (1) 数据实体E-R图

用户

![E-R](Detailed_File/E-R.png)

###### (2) 数据实体描述

| 数据实体名称 | 数据库表名     | 数据实体描述             |
| ------------ | -------------- | ------------------------ |
| 用户         | User           | 用户信息                 |
| 商品         | Goods          | 商品信息                 |
| 订单         | Orders         | 订单信息                 |
| 评价         | Review         | 评价信息                 |
| 购物车       | Cart           | 购物车信息               |
| 金额记录     | AmountRecord   | 金额变动记录             |
| 购买偏好     | PurchasePre    | 用户对不同商品的购买频率   |
| 手续费率     | Commissionrate | 商家等级所对应的手续费率 |

###### (3) 实体关系描述

1. 用户：商品（1：n）
   关系描述：一位商家可以发布多个商品并进行管理；

2. 用户：金额记录（1：n）
   关系描述：一位用户的金额变动记录会有多条；

3. 用户：购买偏好（1：1）
   关系描述：一位用户的购买次数和浏览次数统计只有一条记录；

4. 用户：购物车（1：n）
   关系描述：一位用户可以拥有多条购物车记录；

5. 用户：订单（1：n）
   关系描述：一位用户可以拥有多条订单记录；

6. 商品：订单（1：n）
   关系描述：一个商品可以在订单表中拥有多条记录；

7. 商品：购物车（1：n）
   关系描述：一个商品可以在购物车中存在多条记录；

8. 订单：评价（1：1）
   关系描述：一个订单只能评价一次；

9. 订单：手续费（1：1）

   关系描述：一个订单需要使用手续费率表里面的一条记录。


##### 2) 逻辑结构设计

1. Users（<u>Uid</u>，用户名，密码，余额，积分，营业执照，身份证，商家等级，满意度，商家好评率，营业额）

2. Goods（<u>Gid</u>，类型，价格，库存，好评率，照片，说明，状态，新旧程度，发布人，销量）

3. Orders（<u>Oid</u>，Uid，Gid，Rid，单价，提交时间，成交时间，发货时间，退货时间，退货成功时间，状态，手续费，总金额，商家备注，快递单号，地址，数量）

4. Review（<u>Rid</u>，星级，文字，评价时间，评价者，被评价者，被评价者满意度，类型，Oid）

5. AmountRecord（<u>Aid</u>，类型，金额，时间，Oid，Uid，余额）

6. Cart（<u>Cid</u>，Uid，Gid，数量，单价，名称）

7. PurchasePre（<u>Pid</u>，Uid，食品，文具，图书，手机，日用品，家具，电脑，服装，数码，户外，运动）

8. Commission（<u>id</u>，Grade，Rate）

##### 3) 物理设计

* 数据库名称：se-demo
* 存储位置：为了提高系统性能，应根据应用情况将数据的易变部分与稳定部分、经常存取部分和存取频率较低部分分开存放；
* 存取方法：采用Hash索引存储方法；
* 系统配置：关系数据库管理系统产品一般都提供了一些系统配置变量和存储分配参数，供设计人员和数据库管理员对数据库进行物理优化。

#### 3. 运行设计

##### 1) 数据字典设计

###### 用户

| 数据项编号 | 数据项名   | 别名           | 存储结构     |
| ---------- | ---------- | -------------- | ------------ |
| 001        | 用户id     | Uid            | int          |
| 002        | 用户姓名   | Uname          | varchar(45)  |
| 003        | 密码       | Upsw           | varchar(45)  |
| 004        | 手机号码   | Phone          | varchar(45)  |
| 005        | 电子邮件   | email          | varchar(45)  |
| 006        | 城市       | City           | varchar(45)  |
| 007        | 性别       | Sex            | int          |
| 008        | 银行账号   | Bank           | varchar(45)  |
| 009        | 余额       | Account        | double       |
| 010        | 积分       | Point          | int          |
| 011        | 状态       | Status         | int          |
| 012        | 营业执照   | License        | varchar(255) |
| 013        | 身份证     | Identity       | varchar(255) |
| 014        | 等级       | Grade          | int          |
| 015        | 总交易额   | Turnover       | double       |
| 016        | 满意度     | LikeRate       | double       |
| 017        | 商家满意度 | MLikeRate      | double       |
| 018        | 是否为商家 | isMerchant     | int          |
| 019        | 身份证号   | IdentityNumber | varchar(45)  |
| 020        | 地址       | Address        | varchar(45)  |

###### 商品

| 数据项编号 | 数据项名     | 别名         | 存储结构     |
| ---------- | ------------ | ------------ | ------------ |
| 021        | 商品id       | Gid          | int          |
| 022        | 商品名称     | Gname        | varchar(45)  |
| 023        | 商品类型     | type         | varchar(45)  |
| 024        | 商品价格     | Price        | double       |
| 025        | 尺寸大小     | Size         | varchar(45)  |
| 026        | 商品图片     | Picture      | varchar(255) |
| 027        | 使用说明     | Introduction | varchar(45)  |
| 028        | 是否允许仪价 | Bargain      | tinyint      |
| 029        | 商品数量     | Storage      | int          |
| 030        | 新旧程度     | GCondition   | varchar(45)  |
| 031        | 发布人       | Mid          | int          |
| 032        | 评价数       | RNumber      | int          |
| 033        | 销售量       | Sale         | int          |
| 034        | 好评率       | likeRate     | double       |
| 035        | 状态         | Status       | int          |

###### 订单

|数据项编号 | 数据项名 |别名|储存结构|
|-----|-----|-----|-----|
|036|订单编号|Oid|int|
|037|用户编号|Uid|int|
|038|商品编号|Gid|int|
|039|商家编号|Mid|int|
|040|评价|Rid|int|
|041|提交时间|Subtime|datetime|
|042|成交时间|SubSucTime|datetime|
|043|发货时间|SentTime|datetime|
|044|单价|Price|double|
|045|退货时间|RetTime|datetime|
|046|退货成功时间|RetSecTime|datetime|
|047|状态|status|int|
|048|手续费|Commission|double|
|049|地址|Address|varchar(45)|
|050|数量|Number|int|
|051|快递单号|DeliverID|varchar(45)|
|052|总金额|sum|double|
|053|商品名|Gname|varchar(45)|
|054|商家备注|MNote|varchar(45)|

###### 评价信息

|数据项编号 | 数据项名 |别名| 储存结构 |
|-----|-----|-----|---|
| 055 | 评价编号 |Rid|int|
|056|星级|star|int|
|057|文字|Remark|varchar(45)|
|058|评价时间|Time|datetime|
|059|评价者|Fromid| int         |
|060|被评价者|Toid| int |
|061|被评价者满意度|Rate| double |
|062|类型|type| int |
|063|订单|oid| int |

###### 购物车

|数据项编号 | 数据项名 |别名| 储存结构 |
|-----|-----|-----|---|
|064| 购物车编号|Cid|int|
|065|用户编号|Uid|int|
|066|商品编号|Gid|int|
|067|个数|Number|int|
|068|单价|Price|double|
|069|名称|Gname|varchar(45)|

###### 金额记录

|数据项编号 | 数据项名 |别名| 储存结构 |
|-----|-----|-----|---|
|070|记录编号|Aid|int|
|071|类型|Type| tinyint |
|072|金额|Amount|double|
|073|时间|Atime|datetime|
|074|订单编号|Oid|int|
|075|用户编号|Uid|int|
|076|金额|Account|double|

###### 管理员

|数据项编号 | 数据项名 |别名| 储存结构 |
|-----|-----|-----|---|
|077|管理员编号|AdmID|int|
|078|管理员密码|password|varchar(45)|

###### 手续费率

| 数据项编号 | 数据项名     | 别名  | 储存结构 |
| ---------- | ------------ | ----- | -------- |
| 079        | 手续费率编号 | id    | int      |
| 080        | 商家等级     | Grade | int      |
| 081        | 手续费率     | Rate  | double   |

###### 购买偏好

| 数据项编号 | 数据项名     | 别名  | 储存结构 |
| ---------- | ------------ | ----- | -------- |
| 082        | 购买偏好编号 | Pid    | int      |
| 083        | 用户id     | Uid | int      |
| 084        | 食品     | food  | int   |
| 085        | 文具     |  stationery | int   |
| 086        | 图书     | book  | int   |
| 087        | 手机     |  phone | int   |
| 088        | 日用品     |  dailyNecessities| int   |
| 089        | 家具     | furniture  | int   |
| 090        | 电脑     |  computer | int   |
| 091        | 服装     |  clothing | int   |
| 092        | 数码     |  digital | int   |
| 093        | 户外     |  outdoors | int   |
| 094        | 运动     | sport  | int   |

##### 2) 安全保密设计

系统的管理权限如下

|              | 用户 | 商家 | 管理员 |
| ------------ | ---- | ---- | ------ |
| 商品管理     |      | √    | √      |
| 用户管理     |      |      | √      |
| 商家管理     |      |      | √      |
| 订单管理     | √    | √    |        |
| 评价管理     | √    | √    |        |
| 金额记录管理 | √    | √    |        |
| 购物车管理   | √    | √    |        |


