<center>  

# 基于推荐算法开发商城交易网站
#
#
## 概要设计说明书
#
#
#

__项目名称：
<span style="border-bottom:2px solid black;">
&emsp;基于推荐算法开发商城交易网站&emsp;</span>__

**招标编号：
<span style="border-bottom:2px solid black;">
&emsp;&emsp;&emsp;WYYD20220913001&emsp;&emsp;&emsp;&emsp;</span>**

**招标机构：
<span style="border-bottom:2px solid black;">
&emsp;无言以对电子商务有限公司&emsp;&emsp;&emsp;</span>**

**招标日期：
<span style="border-bottom:2px solid black;">&nbsp;&ensp;&ensp;2022&ensp;&ensp;&ensp;</span>年
<span style="border-bottom:2px solid black;">&nbsp;&emsp;09&emsp;&nbsp;</span>月
<span style="border-bottom:2px solid black;">&emsp;&nbsp;20&emsp;&nbsp;</span>日**
</center>  

#

---
* 项目名称：基于推荐算法开发商城交易网站
* 项目标识：20220920
* version：1.0.0
* 状态与版本信息
    * 文件状态：编写完成
    * 文件标识：Assignment20220920
    * 当前版本：1.0.0
    * 作者
        * 姓名：那婷婷 叶莹
        * 学号：2019011150 2019011152
        * 团队：无言以队任务书小组
    * 完成日期：2022年9月20日
    * 版本更新信息：https://github.com/nopac/SE-Demo
* 引言
    * 使用人员: 参加该项目的所有开发人员
    * 编写目的: 使开发人员初步了解本项目所开发的软件
    * 背景
    * 定义与缩写
        * 独立型项目组
            * 独立型项目组是指项目之间具有相容性，只要条件允许，就可以任意选择项目群中有利项目加以组合
    * 参考资料



## 一、总体设计

* 需求规定
  * 构建一个交易市场，允许用户（卖家）在线发布商品；在后台审核通过之后，用户（买家）可以在线购买下单，购买商品。同时可以针对购买的商品，可以在线进行评论，对于商品和买家进行评论反馈。
  * 该系统由商城交易和后台管理审核系统两个部分组成。后台管理审核，主要是负责对于用户人员、线上发布商品的审核管理功能。
  * 该交易系统主要是提供在线商品的浏览和搜索，并提供用户下单购买的主要流程；同时提供用户注册，提供用户个人信息和购买历史记录等信息。
  * 在商城首页根据当前用户的历史购买记录和浏览记录来推荐其喜好的商品类型
* 运行环境
  * 软件环境：
    * 操作系统：Windows
    * 数据库服务器端系统：MySQL
  * 硬件环境：
    * 服务器端包括一台标准服务器，客户端包括PC客户机
* 基本设计概念和处理流程<br>
  <img src="https://github.com/nopac/SE-Demo/blob/main/doc_week03/Summary_File/module.png?raw=true"/><br>
  <center>图一 交易平台系统</center>
  <img src="https://github.com/nopac/SE-Demo/blob/main/doc_week03/Summary_File/module_2.png?raw=true"/><br>
  <center>图二 后台审核管理系统</center>
  <img src="https://github.com/nopac/SE-Demo/blob/main/doc_week03/Summary_File/sequence.png?raw=true"/><br>
  <center>图三 用户购买商品时序图</center>

* 结构<br>
  <img src="https://github.com/nopac/SE-Demo/blob/main/doc_week03/Summary_File/structure.png?raw=true"/>
  <center>图四 交易平台结构图</center>
* 功能需求与个部分程序的关系

* 人工处理过程

* 尚未问决的问题
  * 评论模块的完善
  * 支付选择沙箱or模拟支付过程
* 自由表述


## 二、 接口设计


* 用户接口
    1. 商城（首页）<br>
       用户在进入网址时显示的首页为商品展示界面，在无需登录的情况下用户即可以点击查看商品详情，也可以搜索所需的商品。
       同时，对商品也可以按照价格等进行排序。但是在未登录的情况下用户仅可以查看，无法加入购物车或者购买。
       当用户需要登录可以点击右上方图标下拉菜单中的登录，若还未注册账号则可以点击注册进行注册。
    2. 用户的注册与登录
        1. 用户可以通过登录界面进行登录，若用户名或密码错误会进行提示。
        2. 用户可以通过注册界面进行注册，用户名限制不可重复，所以如果用户起了与其他人相同的用户名就会被提示用户名已存在。
           在用户确认注册前需要输入验证码，验证码正确才可注册。
    3. 用户信息管理
       用户可以对自己的信息进行查看与修改。用户还可以进行充值，或申请成为商家。
       如果用户想申请成为商家，需要在点击后的弹窗中上传身份证与营业执照照片由管理员审核，管理员审核通过后方可成为商家。
    4. 用户订单管理
       用户在商城中的商品详情界面可以直接下订单，也可以在管理界面中“我的购物车”界面选择多个商品一键下单。
       当跳转到支付界面确认支付时会自动使用积分抵扣一部分金额。若实付金额比账户余额大，则会提示余额不足，
       用户需要进行充值后才能下单。下单后用户可以管理自己的订单，分别为：收货管理、退货管理、评价管理与全部订单。
       收货管理会显示订单的状态，如：待发货、已发货。用户确认收货后可以选择进行评价或是退货。
       如果用户退货申请被拒绝，则会显示商家的拒绝原因。
    5. 商家商品管理
        1. 商品管理界面会显示商品的各项简易信息，点击下拉框会显示商品的详细信息。在下拉框中可以将商品进行下架或重新上架，重新上架的商品需重新进行审核。可以点击操作中的编辑和删除按钮进行商品信息的修改和商品的删除。
        2. 商品列表上方会显示商家的营业额、商家等级与好评率。
        3. 点击新增商品会跳转到新增商品界面，可以填写商品各项信息并上传商品图片。在确认新增商品后新增的商品需经过管理员审核后才会在商城中显示。
    6. 商家订单管理
        1. 发货管理
           商家点击发货后在弹窗中输入快递单号，提交后表示发货成功。
        2. 退货审核
           商家点击通过，表示同意退货。
           商家点击拒绝后在弹窗中输入拒绝原因后拒绝用户退货。
        3. 订单管理
           商家点击评价可以对下订单的用户进行评价。
    7. 管理员后台系统
        1. 用户管理<br>
           查看用户的详细信息，并对用户进行增删改查
        2. 商品管理<br>
            1. 查看商品的详细信息，并对商品进行增删改查
            2. 下架商品
        3. 商家管理
            1. 查看商家的详细信息，并对商家进行增删改查
            2. 手动调整商家的等级（1~5级，5级为最低级），等级越高手续费越少
        4. 手续费管理
            1. 查看每一笔交易的信息与所收取的手续费
        5. 审核管理
            1. 用户审核<br>
               可以查看用户的详细信息，并通过或拒绝用户的注册申请
            2. 商家审核<br>
               可以查看用户提交的营业执照、身份证照片与详细信息，并通过或拒绝用户的商家申请
            3. 商品审核<br>
               可以查看商品的详细信息，并通过或拒绝商品的新增申请
* 外部接口
    * 硬件接口<br>
    
    | 模块|键盘|鼠标|
    | --- | --- |--- |
    | **主模块**  |   √ | √ |
    | **管理员模块**  |   √  | √ |

    * 软件接口<br>
        通过网址访问
* 内部接口
    * 硬件接口
        无
    * 软件接口<br>
      http://localhost:9090/
      
      | AdministratorsController |        | /adm                        |                                       |                       |                                                                                       |
      | :----------------------- | :----- | :--------------------- | :------------------------------------ | :-------------------- | :------------------------------------------------------------------------------------ |
      | 方法名                      | 请求类型   | 路径                     | 所需参数                                  | 实现功能                  | 备注                                                                                    |
      | login                    |        |  /adm                 | Administrators adm                    | 确认用户名密码是否正确或存在        |                                                                                       |
      |                          |        |                        |                                       |                       |                                                                                       |
      | **UserController**           |        |  **/user**                      |                                       |                       |                                                                                       |
      | save                     | post   | /user                  | Users users                           | 存入新用户                 | 能判断密码是否为null与用户名是否存在。（前端）判断验证码是否正确                                                    |
      | login                    | post   | /user/login            | Users users                           | 判断是否能登录               |                                                                                       |
      | update                   | put    | /user                  | Users users                           | 更新用户数据                |                                                                                       |
      | delete                   | delete | /user/{id}             | id                                    | 根据id删除用户              |                                                                                       |
      | judgeName                | get    | /user/judgeName/{name} |  name                                 | 判断数据库中是否已存在此用户名       |                                                                                       |
      | getInfo                  | get    | /user/getInfo/{name}   |  name                                 | 判断用户名是否已被注册           | 用户名唯一，便于查找                                                                            |
      | findPage                 | get    | /user                  | pageNumber, pageSize, searchText      | 根据当前页、每页条数和查询内容进行分页查询 |                                                                                       |
      | createCode               |        |                        |                                       |                       | 生成验证码                                                                                 |
      |                          |        |                        |                                       |                       |                                                                                       |
      | **GoodsController**          |        |  **/goods**                      |                                       |                       |                                                                                       |
      | save                     | post   | /goods                 | Goods goods                           | 存入商品                  | 能判断密码是否为null与用户名是否存在                                                                  |
      | update                   | put    | /goods                 | Goods goods                           | 更新商品数据                |                                                                                       |
      | delete                   | delete | /goods/{id}            | id                                    | 根据id删除商品              | 删除订单后需修改内容：（导图）搜索不可见、购物车标明下架，用户查看订单时标明已下架，商家后台可再修改为上架                                 |
      | findPage                 | get    | /goods                 | pageNumber, pageSize, searchText      | 根据当前页、每页条数和查询内容进行分页查询 |                                                                                       |
      | searchGood               | get    | /goods/goodDetails     | Gid                                   | 查询商品详情                |                                                                                       |
      |                          |        |                        |                                       |                       |                                                                                       |
      | **OrdersController**         |        | **/orders**                        |                                       |                       |                                                                                       |
      | save                     | post   | /orders                | Orders orders                         | 存入商品                  | 新增订单需要修改内容：1 用户钱包金额减少 2 购物车相应记录删除 3 新增订单，在函数中插入提交时间，修改订单状态                            |
      | update                   | put    | /orders                | Orders orders                         | 更新商品数据                | 订单需要修改吗？                                                                              |
      | delete                   | delete | /orders/{id}           | id                                    | 根据id删除商品              | 订单什么时候会被删除？不需要                                                                        |
      | received                 | put    |                        |                                       |                       | 确认收货需要修改内容：1. 订单状态修改，成交时间增加 2. 24小时后成交，不可退货；用户积分增加；商品销量增加；商家营业额增加，总交易额增加；平台判断商家等级，收取手续费 |
      | findPage                 | get    | /orders                | pageNumber, pageSize, searchText      | 根据当前页、每页条数和查询内容进行分页查询 |                                                                                       |
      |                          |        |                        |                                       |                       |                                                                                       |
      | **CartController**           |        |  **/cart**                      |                                       |                       |                                                                                       |
      | addCartGood              | post   | /cart                  | Cart                                  | 存入购物车                 |                                                                                       |
      | getCartGood              | get    | /cart                  | uid                                   | 获取购物车                 |                                                                                       |
      | getCartGood              | put    | /cart                  | Cart                                  | 更新数量                  |                                                                                       |
      | delete                   | delete | /cart/{cid}            | cid                                   | 删除                    |                                                                                       |



## 三、 运行设计
### 运行模块组合
1. 输入模块和数据库模块:以实现数据的存储插入
2. 输入模块和系统设计模块: 实现通过数据输入来设计系统需求功能
3. 系统设计模块和输出模块:实现向用户展示设计结果功能
4. 输出模块和硬件监测模块:实现实时数据的传输和更新
### 运行控制
1. 输入:用户通过输入设备进行信息输入，提交至系统内进行逻辑交互。
2. 输出:根据用户操作业务返回对应的输出信息,完成用户的逻辑交互。
3. 逻辑处理:当用户提交处理信息后，根据后端逻辑处理用户信息。
### 运行时间
1. 输入模块:取决于用户输入的时间，不可控制的因素
2. 分析模块：通过用户选择需求，为用户分配服务对象，该模块逻辑简单，预计耗时在3s内。
3. 处理模块：由于任务量大，并发访问度高,且用户需求不一，因此应针对用户具体需求进行讨论。预估的平均时间在每项任务15s内。

## 四、 系统数据结构设计

- 用户  

|数据类型 | 名称 |属性名| 约束 |  备注   |   
|-----|-----|-----|---|----|
|int|用户编号|Uid|非空|
|String|姓名|Uname|非空|
|String|密码|Upsw|非空|
|String|手机号|Phone|
|String|邮箱|Email|
|String|城市|City|
|int|性别|Sex| |0-女，1-nan|
|String|银行账户|Bank|
|double|余额|Account|默认0|
|int|积分|Point|默认0|
|int|状态|Status|3|1-审核通过，0-不通过，3-审核中，4-黑名单|
|image|营业执照|License|
|image|身份证|Identity|非空|
|int|商家等级|Grade|默认5|
|double|总交易额|Turnover|默认0|
|double|满意度|LikeRate|默认100%|其他商家对消费者身份打的分|
|double|商家好评率|MLikeRate|默认100%|买家对商家身份打的分|
|int|是否为商家|isMerchant|默认0|0-不是，1-成为商家，2-待审核，-1-被拒绝|
|String|身份证号|IdentityNumber|
|String|地址|Address|

- 商品

|数据类型 | 名称 |属性名| 约束 |  备注   |   
|-----|-----|-----|---|----|
|String|商品名称|Gname|非空|
|Sting|类别|type|
|double|价格|Price|非空|
|String|尺寸大小|Size|
|image|照片|Picture|默认图片|默认图片上传（商家未上传）|
|String|使用说明|Introduction|
|bool|是否允许议价|Bargain|默认允许|1-允许，0-不允许|
|int|商品数量|Storage|
|String|新旧程度| GCondition| |用户自己描述|
|String|发布人|Mid| |发布者的Uid|
|int|评价数|RNumber|
|int|销售量|Sale|
|double|好评率|likeRate|
|int|状态|Status| | 1-审核通过，0-不通过，3-审核中，4-下架|








## 五、 系统出错处理设计

| 编号  | 逻辑流程   | 出错原因           | 解决方法                  |
|-----|--------|----------------|-----------------------|
| 01  | 登录     | 用户名或密码错误       | 系统提示输入有误，请用户重新输入账户密码。 |
| 02  | 登录     | 验证码出错          | 刷新验证码，用户重新输入          |
| 03  | 注册     | 用户名已占用         | 提示用户重新注册信息            |
| 04  | 注册     | 用户注册密码格式低于6位   | 提示用户按照系统规定完善注册信息      |
| 05  | 注册     | 两次密码输入不同       | 提示密码和确认密码不同           |
| 06  | 用户购买商品 | 用户在未登录的情况下购买商品 | 提示用户登陆注册              |
| 07  | 用户购买商品 | 用户余额不足         | 提示用户进行充值              |
| 08  | 用户购买商品 | 购买量超出库存量       |提示物品库存不足，不能购买|
|09| 商家添加商品 | 输入的商品总数不为整数    |提示输入信息有误，重新输入|
|10| 商家添加商品 | 输入的商品简介过长      |提示商品信息输入不符合系统规定，重新输入|


